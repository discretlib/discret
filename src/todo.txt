
Database: 
    
    --Rooms
    get_rooms_for_user(user)
    get_room(id)
    add_room(RoomDbDefinition)
    room modification triggers an event: room_id users[]



    --synchronisation function
    get_log_for_room(room, start_date),
    get_node_ids_for_dates(room, vec<dates>)
    get_nodes(vec<id>)
    add_nodes(Vec<FullNode>)
    get node_del_log_for_dates(room, vec<dates>)
    get_edges_for_dates(Vec<date>)
    get edge_del_log_for_dates(room, vec<dates>)
    add_edges(vec<Edges>)




    implements direct node and edge insertion
        in batch
        the node and edge with associated room edges
        intercept room creation note the id of new room creation from node

    get nodes in batch, with associated room edges
    get edges in batch


    
    get room nodes and edges in one query
    get all rooms for user

    implement sys_ virtual tables in the datamodel
        table that will allow to query event log and performances

    better null and not null entity handling in querie, setting an entity to null should also implies a nullable(field)
    add a priority thread to database for interactive queries
    add performance monitoring service


    synchronisation
        register a sync handler
        register a Connection (verfying_key, mpsc)
            send rooms for the key
        roomsreveived
            get missing room
        synchronise new room
            verify history
            mark complete

        synchronise others based on most recent update
            verify history
    
    log handler
        when synchronisation is complete
        conflicts
        conn is create_di
        disconnect
        
    after mutation
        send 
        

    test allow selection of archived entity(starting with $)
    undelete entity through a mutation





    - update room definitions

    - get daily node log for each rooms
    - compare
        add new
        if missing lines
            get deletion log for date and compare 
                if diff might be an update
            update more recent load
        
    - get todays log
    - recompare

    //rinf for flutter

// let instance_map = 
//     .map
//     .entry(key)
//     // and create a new one if not
//     .or_insert(HashMap::new());

